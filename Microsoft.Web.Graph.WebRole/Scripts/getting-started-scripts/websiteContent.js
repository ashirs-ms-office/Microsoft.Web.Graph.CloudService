var contentFilesJson = {
    "ContentFiles": [
        //{
        //    "Id": "option-ios",
        //    "SetupFileFullPath": "\/Modules\/Graph.GettingStarted\/Documentation\/rest-api\/ios\/setup-ios.html",
        //    "GettingStartedFileFullPath": "\/Documentation\/rest-api\/ios\/getting-started-Office-365-APIs-ios.html",
        //    "GithubMDFileName": "rest-api\/ios\/getting-started-Office-365-APIs-ios.md",
        //    "PostDownloadInstructions": "Almost there! To get it running:<br /><ul><li>1. Unzip the downloaded package. </li><li>2. Navigate to the swift or objective-c project folder.</li><li>3. Run pod install.</li><li>4. Open the workspace in Xcode and run.</li></ul>",              
        //},
        {
            "Id": "option-ios-swift",
            "SetupFileFullPath": "\/Modules\/Graph.GettingStarted\/Documentation\/rest-api\/ios\/setup-ios-swift.html",            
            "PostDownloadInstructions": "Almost there! To get it running:<br /><ul><li>1. Unzip the downloaded package. </li><li>2. Navigate to the swift or objective-c project folder.</li><li>3. Run pod install.</li><li>4. Open the workspace in Xcode and run.</li></ul><p>To see how this sample was created, please see our getting started <a href='http://graph.microsoft.io/en-us/docs/platform/ios' target='_blank'>walkthrough</a>.</p>",
        },
        {
            "Id": "option-ios-objective-c",
            "SetupFileFullPath": "\/Modules\/Graph.GettingStarted\/Documentation\/rest-api\/ios\/setup-ios-objective-c.html",
            "PostDownloadInstructions": "Almost there! To get it running:<br /><ul><li>1. Unzip the downloaded package. </li><li>2. Navigate to the swift or objective-c project folder.</li><li>3. Run pod install.</li><li>4. Open the workspace in Xcode and run.</li></ul><p>To see how this sample was created, please see our getting started <a href='http://graph.microsoft.io/en-us/docs/platform/ios' target='_blank'>walkthrough</a>.</p>",
        },
        {
            "Id": "option-android",
            "SetupFileFullPath": "\/Modules\/Graph.GettingStarted\/Documentation\/rest-api\/android\/setup-android.html",
            "GettingStartedFileFullPath": "\/Documentation\/rest-api\/android\/getting-started-Office-365-APIs-android.html",
            "GithubMDFileName": "rest-api\/android\/getting-started-Office-365-APIs-android.md",
            "PostDownloadInstructions": "Almost there! To get it running: Unzip downloaded package, open project, and run.<p>To see how this sample was created, please see our getting started <a href='http://graph.microsoft.io/en-us/docs/platform/android' target='_blank'>walkthrough</a>.</p>",
        },
        {
            "Id": "option-dotnet",
            "SetupFileFullPath": "\/Modules\/Graph.GettingStarted\/Documentation\/rest-api\/dotnet\/setup-dotnet.html",
            "GettingStartedFileFullPath": "\/Documentation\/rest-api\/dotnet\/getting-started-Office-365-APIs-dotnet.html",
            "GithubMDFileName": "rest-api\/dotnet\/getting-started-Office-365-APIs-dotnet.md",
            "PostDownloadInstructions": "Almost there! To get it running: Unzip downloaded package, open solution, and run.<p>To see how this sample was created, please see our getting started <a href='http://graph.microsoft.io/en-us/docs/platform/aspnetmvc' target='_blank'>walkthrough</a>.</p>",
        },
        {
            "Id": "option-javascript",
            "SetupFileFullPath": "\/Modules\/Graph.GettingStarted\/Documentation\/rest-api\/javascript\/setup-javascript.html",
            "GettingStartedFileFullPath": "\/Documentation\/rest-api\/javascript\/getting-started-Office-365-APIs-javascript.html",
            "GithubMDFileName": "rest-api\/javascript\/getting-started-Office-365-APIs-javascript.md",
            "PostDownloadInstructions": "Thanks! Your project is on its way from GitHub. To continue: Unzip downloaded package and run.",
        },

        {
            "Id": "option-node",
            "SetupFileFullPath": "\/Modules\/Graph.GettingStarted\/Documentation\/rest-api\/node\/setup-node.html",
            "GettingStartedFileFullPath": "\/Documentation\/rest-api\/node\/getting-started-Office-365-APIs-node.html",
            "GithubMDFileName": "rest-api\/node\/getting-started-Office-365-APIs-node.md",
            "PostDownloadInstructions": "Almost there! To get it running: Unzip downloaded package, change directory to the project and run:<br /><ul><li><b>&nbsp;&nbsp;&nbsp;&nbsp;npm install</b></li><li><b>&nbsp;&nbsp;&nbsp;&nbsp;npm start</b></li></ul>Then open your browser to the specified port (i.e. <a href='http://localhost:3000' target='_blank'>http://localhost:3000</a>).<p>To see how this sample was created, please see our getting started <a href='http://graph.microsoft.io/en-us/docs/platform/nodejs' target='_blank'>walkthrough</a>.</p>",
        },
        {
            "Id": "option-php",
            "SetupFileFullPath": "\/Modules\/Graph.GettingStarted\/Documentation\/rest-api\/php\/setup-php.html",
            "GettingStartedFileFullPath": "\/Documentation\/rest-api\/php\/getting-started-Office-365-APIs-php.html",
            "GithubMDFileName": "rest-api\/php\/getting-started-Office-365-APIs-php.md",
            "PostDownloadInstructions": "Almost there! To get it running:  Unzip downloaded package. Run the command <b>composer install</b> to install the required dependencies and <b>php –S 0.0.0.0:8000 –t app</b> to start the web server. Access the app at <a href='http://localhost:8000' target='_blank'>http://localhost:8000</a>.<p>To see how this sample was created, please see our getting started <a href='http://graph.microsoft.io/en-us/docs/platform/php' target='_blank'>walkthrough</a>.</p>",
        },
        {
            "Id": "option-python",
            "SetupFileFullPath": "\/Modules\/Graph.GettingStarted\/Documentation\/rest-api\/python\/setup-python.html",
            "GettingStartedFileFullPath": "\/Documentation\/rest-api\/python\/getting-started-Office-365-APIs-python.html",
            "GithubMDFileName": "rest-api\/python\/getting-started-Office-365-APIs-python.md",
            "PostDownloadInstructions": "Almost there! To get it running: <br/><ul><li>1. Unzip downloaded package, navigate to the folder. </li><li>2. Install the <a href='http://www.python-requests.org/en/latest/' target='_blank'>Requests: HTTP for Humans</a> library by running <b>pip install requests</b>.</li><li>3. Run <b>python manage.py migrate</b> to initialize the database for the app. </li><li>4. Then run <b>python manage.py runserver</b> to start your server.</li><li>5. Go to <a href='http://127.0.0.1:8000' target='_blank'>http://127.0.0.1:8000</a> in your web browser.</li></ul>",
        },
        {
            "Id": "option-ruby",
            "SetupFileFullPath": "\/Modules\/Graph.GettingStarted\/Documentation\/rest-api\/ruby\/setup-ruby.html",
            "GettingStartedFileFullPath": "\/Documentation\/rest-api\/ruby\/getting-started-Office-365-APIs-ruby.html",
            "GithubMDFileName": "rest-api\/ruby\/getting-started-Office-365-APIs-ruby.md",
            "PostDownloadInstructions": "Almost there! To get it running:<br/><br/><ul><li>1. Unzip downloaded package and go to the folder. </li><li>2. If you don't already  have bundler and rack, you can install them with the following command: <br/><b>&nbsp;&nbsp;&nbsp;&nbsp;gem install bundler rack</b>. </li><li>3. Install the Rails application and dependencies with the following command: <br/><b>&nbsp;&nbsp;&nbsp;&nbsp;bundle install</b></li><li>4. To start the Rails application, type the following command: <br /><b>&nbsp;&nbsp;&nbsp;&nbsp;rackup -p 3000</b></li><li>5. Go to <a href='http://localhost:3000' target='_blank'>http://localhost:3000</a> in your web browser. </li></ul><p>To see how this sample was created, please see our getting started <a href='http://graph.microsoft.io/en-us/docs/platform/ruby' target='_blank'>walkthrough</a>.</p>",
        },
        {
            "Id": "option-angular",
            "SetupFileFullPath": "\/Modules\/Graph.GettingStarted\/Documentation\/rest-api\/angular\/setup-angular.html",
            "GettingStartedFileFullPath": "\/Documentation\/rest-api\/angular\/getting-started-Office-365-APIs-angular.html",
            "GithubMDFileName": "rest-api\/ruby\/getting-started-Office-365-APIs-angular.md",
            "PostDownloadInstructions": "Almost there! To run the code sample:<br/><ul><li>1. Unzip the downloaded package to a folder, and go to that folder in your command-line tool. </li><li>2. Run <b>npm install</b> and <b>bower install hello</b> to install project dependencies. </li><li>3.Run <b>npm start</b> and go to <a href='http://localhost:8080/' target='_blank'>http://localhost:8080/</a> in your web browser. </li></ul><p>To see how this sample was created, please see our getting started <a href='http://graph.microsoft.io/en-us/docs/platform/angular' target='_blank'>walkthrough</a>.</p>",
        },
        {
            "Id": "option-windowsuniversal",
            "SetupFileFullPath": "\/Modules\/Graph.GettingStarted\/Documentation\/rest-api\/windowsuniversal\/setup-windowsuniversal.html",
            "GettingStartedFileFullPath": "\/Documentation\/rest-api\/windowsuniversal\/getting-started-Office-365-APIs-windowsuniversal.html",
            "GithubMDFileName": "rest-api\/ruby\/getting-started-Office-365-APIs-windowsuniversal.md",
            "PostDownloadInstructions": "Almost there! To get it running: Unzip downloaded package, open solution, and run.<p>To see how this sample was created, please see our getting started <a href='http://graph.microsoft.io/en-us/docs/platform/uwp' target='_blank'>walkthrough</a>.</p>",
        },
        {
            "Id": "option-xamarin",
            "SetupFileFullPath": "\/Modules\/Graph.GettingStarted\/Documentation\/rest-api\/xamarin\/setup-xamarin.html",
            "PostDownloadInstructions": "Almost there! To get it running: Unzip downloaded package, open solution, and run.<p>To see how this sample was created, please see our getting started <a href='http://graph.microsoft.io/en-us/docs/platform/xamarin' target='_blank'>walkthrough</a>.</p>",
        }
    ]
}
function setDocumentationDivForPlatform(platformId, fileType, divName)
{
    var index = 0;
    for (; index < window.platformData.length; ++index) {
        if (platformId == window.platformData[index].Id)
            break;
    }
    var html = '<h1>' + window.platformData[index].PreDownloadInstruction.Title + '</h1>';
    html += '<p>' + window.platformData[index].PreDownloadInstruction.Description + '</p>';
    document.getElementById(divName).innerHTML = html;
    document.getElementById("app-reg-title").innerHTML = window.platformData[index].AppRegistrationInstruction.Title;
    document.getElementById("app-reg-desc").innerHTML = window.platformData[index].AppRegistrationInstruction.Description;
    if (window.platformData[index].AppRegistrationInstruction.Notes == "") {
        document.getElementById("app-reg-notes").style.display = 'none';
    }
    else {
        document.getElementById("app-reg-notes").style.display = 'block';
        document.getElementById("app-reg-notes").innerHTML = window.platformData[index].AppRegistrationInstruction.Notes;
    }
}

function redirectEditOnGitHub(platformId)
{
    var gitHubContentLocation = "https://github.com/OfficeDev/office-content/"; //onError it will redirect to master branch

    $.each(contentFilesJson, function (key, contentFiles) {
        $(contentFiles).each(function (index, Id) {
            if (contentFiles[index].Id === platformId) {
                gitHubContentLocation = gitHubContentLocation + "blob/master/" + contentFiles[index].GithubMDFileName;
            }
        });
    });
    window.open(gitHubContentLocation, "_blank");
    ga('send', 'event', 'O365path-Rest', 'EditOnGithub');
    MscomCustomEvent('ms.InteractionType', '4', 'ms.controlname', 'O365apis', 'ms.ea_action', 'CodeSampleEditOnGitHub');
}