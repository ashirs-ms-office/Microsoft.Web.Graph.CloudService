function TryItOut(n,t,i){function w(n){var r='<button id="serviceOption0" class="serviceOptionBlock col-xs-6 col-sm-4 col-md-2 click" value="0">',t,f;for(r+='<span class="graph '+u[0].icon+'"><\/span><p>'+u[0].apiDescription+"<\/p><\/button>",t=1;t<u.length;++t)f="",(i==null||i==""||f.indexOf(i)>-1)&&(r+='<button id="serviceOption'+t+'" class="serviceOptionBlock col-xs-6 col-sm-4 col-md-2" value="'+t+'">',r+='<span class="graph '+u[t].icon+'"><\/span><p>'+u[t].apiDescription+"<\/p><\/button>");r+='<div style="clear:both;"><\/div>';n.html(r)}function l(){k(p);$(o).text("");$("#tryError").html("");h();$("#invokeurlBtn").prop("disabled",!1).css("cursor","pointer")}function h(){var n=b(!0);c.html(n)}function b(){var t=u[r],f,i,n;return f=t.serviceEndPointUri,i=f+t.urlpart,t.parameters.length>0&&(n=$("#paramTable .textbox").val(),(n===undefined||n==null||n=="")&&(n=t.parameters[0].Value),i=i.replace("{0}",n)),i}function k(n){var i=u[r].parameters,o,f,t,c,l,e;if(i.length===0){$(n).empty();return}for(o="<thead><td>Name<\/td><td>Type<\/td><td>Value<\/td><td>Notes<\/td><\/thead>",f="",t=0;t<i.length;++t){var a="<td>"+i[t].Name+"<\/td>",v="<td>"+i[t].Type+"<\/td>",s="";s=r==0?'<td><select aria-label=\'parameter\' id=\'valueSelection\' class=\'textbox\'><option value="Inbox">Inbox<\/option><option value="SentItems">SentItems<\/option><option value="Drafts">Drafts<\/option><option value="DeletedItems">DeletedItems<\/option><\/select><\/td>':r==3?"<td><select aria-label='parameter' id='valueSelection' class='textbox'><option value=\"drive/root/children\">drive/root/children<\/option><option value=\"me/drive\">me/drive<\/option><\/select><\/td>":r==4?'<td><select aria-label=\'parameter\' id=\'valueSelection\' class=\'textbox\'><option value="me">me<\/option><option value="me?$select=skills">me?$select=skills<\/option><option value="me/manager">me/manager<\/option><option value="myOrganization/users">myOrganization/users<\/option><\/select><\/td>':r==5?'<td><select aria-label=\'parameter\' id=\'valueSelection\' class=\'textbox\'><option value="me/memberOf">me/memberOf<\/option><option value="groups/41525360-8eca-49ce-bcee-b205cd0aa747/members">groups/41525360-8eca-49ce-bcee-b205cd0aa747/members<\/option><option value="groups/41525360-8eca-49ce-bcee-b205cd0aa747/drive/root/children">groups/41525360-8eca-49ce-bcee-b205cd0aa747/drive/root/children<\/option><option value="groups/41525360-8eca-49ce-bcee-b205cd0aa747/conversations">groups/41525360-8eca-49ce-bcee-b205cd0aa747/conversations<\/option><\/select><\/td>':"<td><input class='textbox' type='text' value= "+i[t].Value+" /><\/td>";c="<td>"+i[t].Notes+"<\/td>";f+="<tr>"+a+v+s+c+"<\/tr>"}l="<table id='paramTable' class='table'>"+o+f+"<\/table>";e=$(n);e.empty();e.append(l);$("#paramTable .textbox").focusout(function(){var n=$("#paramTable .textbox").val(),t;if(n==""||typeof n===undefined){$("#tryError").html("Please enter a parameter");$("#invokeurlBtn").prop("disabled",!0).css("cursor","default");return}h();t=new RegExp(/^.*?(?=[\^#&\*:<>\{\|\}]).*$/);t.test(n)&&($("#tryError").html("<bold>parameter contains at least one invalid chars<\/bold>"),$("#invokeurlBtn").prop("disabled",!0).css("cursor","default"))});$("#valueSelection").change(function(){var n=$("#paramTable .textbox").val(),t;if(n==""||typeof n===undefined){$("#tryError").html("Please enter a parameter");$("#invokeurlBtn").prop("disabled",!0).css("cursor","default");return}h();t=new RegExp(/^.*?(?=[\^#&\*:<>\{\|\}]).*$/);t.test(n)&&($("#tryError").html("<bold>parameter contains at least one invalid chars<\/bold>"),$("#invokeurlBtn").prop("disabled",!0).css("cursor","default"))});$("#paramTable .textbox").focus(function(){$("#tryError").html("");$("#invokeurlBtn").prop("disabled",!1).css("cursor","pointer");return})}function d(n){function i(n,i,r){t+=r?JSON.stringify(i):i;responseBody=t}var c,t;$("#response-container").show("slow");e.prop("disabled",!0).css("cursor","default");s.addClass("loading");var l=u[r].authToken,h="",f=JSON.parse("{}");f.Accept="application/json";f.Authorization=l;f["ApiExProxy-FixedAadUser"]=1;c="https://apiexproxy.azurewebsites.net/svc?url="+n;t="";ga("send","event","O365path-Rest","Try-it-out-invokeUrlOnSampleData-"+n+"-Begin");$.ajax({url:c,type:"GET",headers:f,success:function(r,u,f){i(t,r,!0);h=f.status;ga("send","event","O365path-Rest","Try-it-out-invokeUrlOnSampleData-"+n+"-Success");MscomCustomEvent("ms.InteractionType","4","ms.controlname","O365apis","ms.ea_action","Try-it-out-invokeUrlOnSampleData-Success","ms.contentproperties",n)},error:function(r,u){var e,f;if(u==="timeout"){i(t,"Timeout occurred...",!1);ga("send","event","O365path-Rest","Try-it-out-invokeUrlOnSampleData-"+n+"-Error-TimeoutError");MscomCustomEvent("ms.InteractionType","4","ms.controlname","O365apis","ms.ea_action","Try-it-out-invokeUrlOnSampleData-Error","ms.contentproperties",n,"ms.callresult","TimeoutError");return}if(e=r.getResponseHeader("ApiExProxy-Error"),r.status=="0"||e!=null&&e!="0")i(t,"Proxy not reachable",!1),ga("send","event","O365path-Rest","Try-it-out-invokeUrlOnSampleData-"+n+"-Error-ProxyNotReachable"),MscomCustomEvent("ms.InteractionType","4","ms.controlname","O365apis","ms.ea_action","Try-it-out-invokeUrlOnSampleData-Error","ms.contentproperties",n,"ms.callresult","ProxyNotReachable");else try{f=$.parseJSON(r.responseText);i(t,f,!0);h=r.status;ga("send","event","O365path-Rest","Try-it-out-invokeUrlOnSampleData-"+n+"-Error-"+f);MscomCustomEvent("ms.InteractionType","4","ms.controlname","O365apis","ms.ea_action","Try-it-out-invokeUrlOnSampleData-Error","ms.contentproperties",n,"ms.callresult",f)}catch(o){i(t,"Unexpected Error occured",!1);ga("send","event","O365path-Rest","Try-it-out-invokeUrlOnSampleData-"+n+"-Error-Unexpected Service Error");MscomCustomEvent("ms.InteractionType","4","ms.controlname","O365apis","ms.ea_action","Try-it-out-invokeUrlOnSampleData-Error","ms.contentproperties",n,"ms.callresult","Unexpected Service Error")}},complete:function(){s.removeClass("loading");o.jsonView(t);e.prop("disabled",!1).css("cursor","pointer")}})}var a,r=0,u=[{name:"Mail API: Get messages",App:"outlook",serviceName:"Mail",serviceEndPointUri:"https://graph.microsoft.com/v1.0",urlpart:"/me/mailFolders/{0}/messages",serverAction:"/GettingStarted/Proxy/EMail",authToken:"Bearer {token:https://graph.microsoft.com/}",img:window.runTimeEnv.getMediaUrl("/media/Default/GettingStarted/devOffice_getting_started_mailblue_53x40.png"),alt:"Mail",icon:"graph-mail",apiDescription:"Get messages",parameters:[{Name:"folder_id",Type:"string",Value:[{value1:"Inbox"},{value2:"SentItems"},{value3:"Drafts"},{value4:"DeletedItems"}],Notes:"The target folder ID or well-known name: Inbox, SentItems, Drafts, or DeletedItems."}]},{name:"Calendar API: Get events",App:"outlook",serviceName:"Calendar",serviceEndPointUri:"https://graph.microsoft.com/v1.0",urlpart:"/me/events?$top=5",serverAction:"/GettingStarted/Proxy/Events",authToken:"Bearer {token:https://graph.microsoft.com/}",img:window.runTimeEnv.getMediaUrl("/media/Default/GettingStarted/devOffice_getting_started_calendarblue_53x50.png"),alt:"Calendar",icon:"graph-calendar",apiDescription:"Get events",parameters:[]},{name:"Contacts API: Get all contacts",App:"outlook",serviceName:"Contacts",serviceEndPointUri:"https://graph.microsoft.com/v1.0",urlpart:"/me/contacts",serverAction:"/GettingStarted/Proxy/Contacts",authToken:"Bearer {token:https://graph.microsoft.com/}",img:window.runTimeEnv.getMediaUrl("/media/Default/GettingStarted/devOffice_getting_started_contactsblue_53x50.png"),alt:"Contacts",icon:"graph-contact",apiDescription:"Get all contacts",parameters:[]},{name:"Files API: Get files",App:"onedrive",serviceName:"MyFiles",serviceEndPointUri:"https://graph.microsoft.com/v1.0",urlpart:"/{0}",serverAction:"/GettingStarted/Proxy/ListFolderContents",authToken:"Bearer {token:https://graph.microsoft.com/}",img:window.runTimeEnv.getMediaUrl("/media/Default/GettingStarted/devOffice_getting_started_filesblue_53x50.png"),alt:"File",icon:"graph-file",apiDescription:"Get files",parameters:[{Name:"file path",Type:"string",Value:[{value1:"drive/root/children"},{value2:"me/drive"},],Notes:"Path of the files."}]},{name:"Users API: ",serviceEndPointUri:"https://graph.microsoft.com/v1.0",urlpart:"/{0}",authToken:"Bearer {token:https://graph.microsoft.com/}",img:window.runTimeEnv.getMediaUrl("/media/Default/GettingStarted/devOffice_getting_started_userblue_53x50.png"),alt:"User",icon:"graph-user",apiDescription:"Get users",parameters:[{Name:"user",Type:"string",Value:[{value1:"me"},{value2:"me?$select=skills"},{value3:"me/manager"},{value4:"myOrganization/users"},],Notes:"User(s) and query strings of user(s) profile."}]},{name:"Groups API: ",serviceEndPointUri:"https://graph.microsoft.com/v1.0",urlpart:"/{0}",authToken:"Bearer {token:https://graph.microsoft.com/}",img:window.runTimeEnv.getMediaUrl("/media/Default/GettingStarted/devOffice_getting_started_groupsblue_53x50.png"),alt:"Group",icon:"graph-group",apiDescription:"Get groups",parameters:[{Name:"group",Type:"string",Value:[{value1:"me/memberOf"},{value2:"groups/41525360-8eca-49ce-bcee-b205cd0aa747/members"},{value3:"groups/41525360-8eca-49ce-bcee-b205cd0aa747/drive/root/children"},{value4:"groups/41525360-8eca-49ce-bcee-b205cd0aa747/conversations"},],Notes:"Groups and query strings of group profile."}]},],f=n,v=t,y=$("#"+f.services),c=$("#"+f.urlValue),o=$("#"+f.responseBody),p=$("#"+f.parameterDetails),e=$("#"+f.invokeurlBtn),s=$("."+v.CodeContainer);w(y);e.on("click",function(){var n=c.text();o.text("");typeof navigator=="undefined"||!document.documentMode&&typeof InstallTrigger=="undefined"||$("#CopyCodeLink").removeClass("hidden");d(n,r)});$(function(){$(".serviceOptionBlock").click(function(){$(this).addClass("click").siblings().removeClass("click");$("#response-container").hide();r=$(this).attr("value");l()})});$(function(){$("#CopyCodeLink").click(function(){copyCode(responseBody)})});l()}var responseBody="";